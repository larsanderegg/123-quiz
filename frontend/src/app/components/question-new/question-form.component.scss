@use '@angular/material' as mat;

.question-form-container {
  // Add padding or max-width if needed for the overall container
  padding: 20px;
  max-width: 900px; // Example max-width for the card
  margin: 20px auto; // Center the card
}

mat-card-header {
  position: relative; // Needed for absolute positioning of progress bar
}

.form-loading-bar {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
}

mat-card-content {
  // Add padding if needed inside the content area
}

// --- Layout Rows ---

// Row 1: Question Text, Order, Round
.question-details-row {
  display: flex;
  flex-wrap: wrap; // Allow wrapping on smaller screens
  align-items: flex-start;
  gap: 16px;
  margin-bottom: 20px; // Consistent spacing

  .question-text-field {
    flex: 1 1 400px; // Grow, shrink, base width
    min-width: 250px; // Prevent getting too small
  }

  .question-order-field {
    flex: 0 0 100px; // Don't grow/shrink, fixed width
  }

  .question-round-field {
    flex: 0 0 200px; // Don't grow/shrink, fixed width
  }
}

// Row 2: Category
.question-meta-row {
  display: flex;
  margin-bottom: 20px; // Consistent spacing

  .category-field {
    width: 100%; // Default to full width
    max-width: 450px; // Limit width if desired
  }
}

// Row 3: Introduction Textarea
.introduction-row {
  margin-bottom: 20px; // Consistent spacing

  .full-width-textarea {
    width: 100%; // Make textarea take full width of its container
  }
}

// Row 4: Explanation Textarea & Image Upload
.explanation-details-row {
  display: flex;
  flex-wrap: wrap; // Allow wrapping
  align-items: flex-start;
  gap: 20px;
  margin-bottom: 24px; // Keep slightly larger margin before answers

  .explanation-text-field {
    flex: 1 1 50%; // Allow text field to take more space
    min-width: 300px;
  }

  .explanation-image-section {
    flex: 1 1 35%; // Allow image section to take space too
    min-width: 250px;
    padding-top: 8px; // Align caption roughly

    h4.mat-caption {
      margin-bottom: 8px;
      color: rgba(0,0,0,0.6);
      font-weight: 500;
    }

    .file-input { display: none; }
    .upload-button { margin-bottom: 10px; display: inline-block; } // inline-block for side-by-side potential

    .image-preview-container {
      position: relative;
      display: inline-block;
      margin-top: 10px;
      margin-left: 10px; // Space from button
      border: 1px solid #ccc;
      padding: 4px;
      background-color: #f9f9f9;
      vertical-align: top; // Align with button top

      .image-preview {
        max-height: 100px; // Adjust size
        max-width: 150px;
        display: block;
        object-fit: contain;
      }

      .clear-image-button {
        position: absolute;
        top: -15px;
        right: -15px;
        background-color: rgba(255, 255, 255, 0.8);
        width: 28px; height: 28px; line-height: 28px;
        mat-icon { font-size: 18px; }
        &:hover { background-color: rgba(220, 220, 220, 0.95); }
      }
    }
  }
}

// --- Answers Section ---
.answers-heading {
  margin-top: 32px; // More space before answers
  margin-bottom: 16px;
  border-top: 1px solid #eee; // Separator line
  padding-top: 16px;
}

.answer-list-container {
  margin-bottom: 16px; // Space before add button
}

.answer-group {
  display: flex;
  align-items: flex-start; // Align top for multi-row content
  gap: 10px;
  padding: 12px 8px;
  margin-bottom: 12px;
  background-color: #f9f9f9; // Light background for answer group
  border: 1px solid #eee;
  border-radius: 4px;
  box-shadow: 0 1px 2px rgba(0,0,0,0.05);

  .drag-handle {
    cursor: move;
    color: #777;
    flex-shrink: 0;
    padding-top: 16px; // Align roughly with first input field baseline
    mat-icon { font-size: 24px; }
  }

  .answer-content-wrapper {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    gap: 12px; // Space between main row and image row
  }

  // Top row (text + checkbox)
  .answer-main-row {
    display: flex;
    flex-wrap: wrap; // Allow wrapping
    align-items: center;
    gap: 15px;

    .answer-text-field {
      flex: 1 1 300px; // Allow text field to grow/shrink
      min-width: 200px;
      // Remove bottom padding for alignment
      .mat-form-field-wrapper { padding-bottom: 0; margin-bottom: 0; }
    }
    .correct-checkbox {
      flex-shrink: 0; // Prevent checkbox from shrinking
      padding-bottom: 20px; // Align checkbox baseline roughly with input text
    }
  }

  // Bottom row (image upload/preview)
  .answer-image-row {
    display: flex;
    align-items: center;
    flex-wrap: wrap; // Allow wrapping
    gap: 10px;
    min-height: 40px;

    .file-input { display: none; }
    .upload-button { flex-shrink: 0; }

    .image-preview-container {
      position: relative;
      display: flex;
      align-items: center;

      .image-preview {
        max-height: 50px;
        max-width: 100px;
        border-radius: 4px;
        border: 1px solid #ccc;
        object-fit: cover;
      }

      .clear-image-button {
        position: absolute;
        top: -10px;
        right: -10px;
        background-color: rgba(255, 255, 255, 0.7);
        width: 24px; height: 24px; line-height: 24px;
        mat-icon { font-size: 16px; }
        &:hover { background-color: rgba(220, 220, 220, 0.9); }
      }
    }
  }

  .remove-button {
    flex-shrink: 0;
    align-self: center; // Center vertically
    margin-left: auto; // Push remove button to the far right
  }
}

// Add Answer Button
.add-answer-button {
  margin-bottom: 20px; // Space before card actions
}

// Card Actions
mat-card-actions {
  padding: 16px !important;
  background-color: rgba(0,0,0,0.02);
  border-top: 1px solid #eee;
}

// CDK Dragging Styles
.cdk-drag-preview {
  box-sizing: border-box;
  border-radius: 4px;
  box-shadow: 0 5px 5px -3px rgba(0, 0, 0, 0.2),
  0 8px 10px 1px rgba(0, 0, 0, 0.14),
  0 3px 14px 2px rgba(0, 0, 0, 0.12);
  // Ensure preview looks like the item
  padding: 12px 8px;
  background-color: white; // Solid background for preview
  // Match relevant styles from .answer-group if needed
}

.cdk-drag-placeholder {
  opacity: 0.3;
  // Placeholder appearance
  background: #ccc;
  border: dotted 2px #999;
  min-height: 80px; // Match rough height of answer group
  transition: transform 250ms cubic-bezier(0, 0, 0.2, 1);
  border-radius: 4px;
}

.cdk-drag-animating {
  transition: transform 250ms cubic-bezier(0, 0, 0.2, 1);
}

.answer-list-container.cdk-drop-list-dragging .answer-group:not(.cdk-drag-placeholder) {
  transition: transform 250ms cubic-bezier(0, 0, 0.2, 1);
}
